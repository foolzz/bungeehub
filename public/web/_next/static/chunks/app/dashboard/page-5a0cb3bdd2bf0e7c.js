(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{7621:(e,s,t)=>{"use strict";t.d(s,{ZQ:()=>i,bI:()=>n,ic:()=>o,ox:()=>d});var a=t(5125);let r=t(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api/v1",l=a.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e});let i={login:(e,s)=>l.post("/auth/login",{email:e,password:s}),register:e=>l.post("/auth/register",e),getProfile:()=>l.get("/auth/profile")},n={getAll:()=>l.get("/hubs"),getMyHubs:()=>l.get("/hubs/my-hubs"),getById:e=>l.get("/hubs/".concat(e)),getMetrics:(e,s)=>l.get("/hubs/".concat(e,"/metrics"),{params:{days:s}}),create:e=>l.post("/hubs",e),update:(e,s)=>l.put("/hubs/".concat(e),s)},d={getAll:e=>l.get("/packages",{params:e}),getById:e=>l.get("/packages/".concat(e)),track:e=>l.get("/packages/tracking/".concat(e))},o={getDashboard:()=>l.get("/admin/dashboard"),getPendingApplications:(e,s)=>l.get("/admin/applications/pending",{params:{page:e,limit:s}}),getApplicationDetails:e=>l.get("/admin/applications/".concat(e)),reviewApplication:(e,s)=>l.post("/admin/applications/".concat(e,"/review"),s)}},8103:(e,s,t)=>{Promise.resolve().then(t.bind(t,9485))},9485:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(5155),r=t(2115),l=t(7621);function i(){var e;let[s,t]=(0,r.useState)(null),[i,n]=(0,r.useState)(!0),[d,o]=(0,r.useState)(""),[c,g]=(0,r.useState)({totalDeliveries:0,earnings:0,rating:0,activePackages:0}),[h,x]=(0,r.useState)([]),[m,u]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{(async()=>{try{var e,s,a,r;let i=(await l.ZQ.getProfile()).data;if(t(i),console.log("User data:",i),"HUB_HOST"===i.role)try{console.log("Fetching hubs for hub host...");let s=await l.bI.getMyHubs();console.log("Hubs response:",s.data);let t=(null==(e=s.data)?void 0:e.data)||[];console.log("User hubs:",t),x(t),u(!0);let a=t.reduce((e,s)=>e+(s.totalDeliveries||0),0),r=t.length>0?t.reduce((e,s)=>e+(s.rating||0),0)/t.length:0;g({totalDeliveries:a,earnings:2.5*a,rating:r,activePackages:t.reduce((e,s)=>{var t;return e+((null==(t=s._count)?void 0:t.packages)||0)},0)})}catch(e){console.error("Error fetching hubs:",e),o("Failed to load hubs: ".concat((null==(a=e.response)||null==(s=a.data)?void 0:s.message)||e.message)),u(!0)}else if("CUSTOMER"===i.role)try{let e=(null==(r=(await l.ox.getAll({limit:5})).data)?void 0:r.data)||[];g({activePackages:e.filter(e=>["IN_TRANSIT","AT_HUB","OUT_FOR_DELIVERY"].includes(e.status)).length,totalDeliveries:e.filter(e=>"DELIVERED"===e.status).length,rating:0,earnings:0})}catch(e){console.error("Error fetching packages:",e)}}catch(e){console.error("Error fetching profile:",e),window.location.href="/login"}finally{n(!1)}})()},[]),i)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl",children:"Loading..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome, ",null==s?void 0:s.fullName,"!"]}),(0,a.jsxs)("p",{className:"text-gray-600 mt-1",children:["Role: ",(0,a.jsx)("span",{className:"font-medium",children:null==s||null==(e=s.role)?void 0:e.replace("_"," ")})]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Email: ",(0,a.jsx)("span",{className:"font-medium",children:null==s?void 0:s.email})]})]}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),window.location.href="/"},className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Logout"})]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:(null==s?void 0:s.role)==="HUB_HOST"?"Total Deliveries":"Active Packages"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-primary-600",children:(null==s?void 0:s.role)==="HUB_HOST"?c.totalDeliveries:c.activePackages})]}),(null==s?void 0:s.role)==="HUB_HOST"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Earnings"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:["$",c.earnings.toFixed(2)]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Estimated at $2.50/delivery"})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Rating"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-yellow-600",children:["★ ",c.rating.toFixed(1)]})]})]}),(null==s?void 0:s.role)==="CUSTOMER"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Delivered"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:c.totalDeliveries})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Track Package"}),(0,a.jsx)("a",{href:"/packages/track",className:"inline-block mt-2 bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700",children:"Track Now"})]})]})]}),d&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:[(0,a.jsx)("strong",{children:"Error:"})," ",d]}),(null==s?void 0:s.role)==="HUB_HOST"&&m&&0===h.length&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"No Hubs Registered Yet"}),(0,a.jsx)("p",{className:"text-yellow-800 mb-4",children:'You haven\'t registered any hubs yet. Click the "Register Your Hub" button below to get started and start earning!'}),(0,a.jsx)("a",{href:"/hubs/register",className:"inline-block bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 font-medium",children:"Register Your First Hub"})]}),(null==s?void 0:s.role)==="HUB_HOST"&&h.length>0&&(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 text-gray-900",children:["My Hubs (",h.length,")"]}),(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>{var s,t,r;return(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-primary-300 transition",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.address}),(0,a.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e.status}),(0,a.jsx)("span",{className:"text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded",children:null==(s=e.tier)?void 0:s.replace("_"," ")})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["★ ",(null==(t=e.rating)?void 0:t.toFixed(1))||"0.0"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.totalDeliveries||0," deliveries"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(null==(r=e._count)?void 0:r.packages)||0," active packages"]})]})]})},e.id)})})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(null==s?void 0:s.role)==="HUB_HOST"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("a",{href:"/hubs/register",className:"block p-4 border-2 border-primary-600 rounded-lg hover:bg-primary-50 transition",children:[(0,a.jsx)("h3",{className:"font-semibold text-primary-600 mb-1",children:"Register Your Hub"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Set up your delivery hub and start earning"})]}),(0,a.jsxs)("a",{href:"/packages",className:"block p-4 border-2 border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[(0,a.jsx)("h3",{className:"font-semibold mb-1 text-gray-900",children:"View Packages"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"See packages assigned to your hub"})]})]}),(null==s?void 0:s.role)==="CUSTOMER"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("a",{href:"/packages/track",className:"block p-4 border-2 border-primary-600 rounded-lg hover:bg-primary-50 transition",children:[(0,a.jsx)("h3",{className:"font-semibold text-primary-600 mb-1",children:"Track Package"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Enter tracking number to see status"})]}),(0,a.jsxs)("a",{href:"/hubs",className:"block p-4 border-2 border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[(0,a.jsx)("h3",{className:"font-semibold mb-1 text-gray-900",children:"Find Hubs"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Locate nearby delivery hubs"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-blue-800",children:[(0,a.jsx)("strong",{children:"Note:"})," This is a basic dashboard. Full functionality coming soon! Check out the"," ",(0,a.jsx)("a",{href:"http://localhost:8080/api-docs",target:"_blank",className:"underline",children:"API documentation"})," ","for all available endpoints."]})})]})})}}},e=>{e.O(0,[125,441,255,358],()=>e(e.s=8103)),_N_E=e.O()}]);