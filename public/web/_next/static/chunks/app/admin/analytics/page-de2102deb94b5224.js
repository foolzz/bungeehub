(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93],{2917:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(5155),r=a(2115),l=a(7621),i=a(5125);function n(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[o,x]=(0,r.useState)(""),[g,m]=(0,r.useState)("rank"),[p,h]=(0,r.useState)({totalHubs:0,totalDeliveries:0,totalEarnings:0,avgRating:0});(0,r.useEffect)(()=>{u()},[]),(0,r.useEffect)(()=>{a.length>0&&y()},[g]);let u=async()=>{try{let e=await l.ZQ.getProfile();if("ADMIN"!==e.data.role){window.location.href="/dashboard";return}await b()}catch(e){window.location.href="/login"}},b=async()=>{try{var e;d(!0);let a=localStorage.getItem("token"),s=(null==(e=(await i.A.get("http://localhost:8080/api/v1/admin/hubs",{headers:{Authorization:"Bearer ".concat(a)}})).data)?void 0:e.data)||[];t(s);let r=s.map(e=>{let t=e.totalDeliveries||0,a=parseFloat(e.rating)||0,s=24*Math.random()+12,r=85+14*Math.random(),l=Math.max(0,100-s/48*100),i=8*a+.3*r+.2*l+Math.min(t/10,10);return{id:e.id,name:e.name,address:e.address,tier:e.tier,totalDeliveries:t,rating:a,estimatedEarnings:2.5*t,deliverySpeed:s,successRate:r,rankScore:i}});n(r);let l=r.reduce((e,t)=>e+t.totalDeliveries,0),c=r.reduce((e,t)=>e+t.estimatedEarnings,0),o=r.length>0?r.reduce((e,t)=>e+t.rating,0)/r.length:0;h({totalHubs:r.length,totalDeliveries:l,totalEarnings:c,avgRating:o})}catch(e){console.error("Error fetching analytics:",e),x("Failed to load analytics")}finally{d(!1)}},y=()=>{n([...a].sort((e,t)=>{switch(g){case"rank":return t.rankScore-e.rankScore;case"earnings":return t.estimatedEarnings-e.estimatedEarnings;case"speed":return e.deliverySpeed-t.deliverySpeed;case"rating":return t.rating-e.rating;default:return 0}}))},j=(e,t)=>"rating"===t?e>=4.5?"text-green-600":e>=4?"text-blue-600":e>=3.5?"text-yellow-600":"text-red-600":"speed"===t?e<=18?"text-green-600":e<=24?"text-blue-600":e<=30?"text-yellow-600":"text-red-600":"success"===t?e>=95?"text-green-600":e>=90?"text-blue-600":e>=85?"text-yellow-600":"text-red-600":"text-gray-600";return c?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-xl",children:"Loading analytics..."})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Hub Analytics & Rankings"}),(0,s.jsx)("a",{href:"/admin",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Back to Admin Dashboard"})]}),o&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:o}),(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Total Hubs"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-primary-600",children:p.totalHubs})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Total Deliveries"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:p.totalDeliveries.toLocaleString()})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Total Earnings"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:["$",p.totalEarnings.toLocaleString()]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Estimated platform fees"})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-700",children:"Avg Rating"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-yellow-600",children:["★ ",p.avgRating.toFixed(1)]})]})]}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>m("rank"),className:"px-4 py-2 rounded-md text-sm font-medium ".concat("rank"===g?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Overall Rank"}),(0,s.jsx)("button",{onClick:()=>m("earnings"),className:"px-4 py-2 rounded-md text-sm font-medium ".concat("earnings"===g?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Earnings"}),(0,s.jsx)("button",{onClick:()=>m("speed"),className:"px-4 py-2 rounded-md text-sm font-medium ".concat("speed"===g?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Speed"}),(0,s.jsx)("button",{onClick:()=>m("rating"),className:"px-4 py-2 rounded-md text-sm font-medium ".concat("rating"===g?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Rating"})]})]})}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Hub Rankings"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Rankings based on rating (40%), success rate (30%), delivery speed (20%), and volume (10%)"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hub Details"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tier"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deliveries"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Earnings"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Speed"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Success Rate"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank Score"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((e,t)=>{var a;let r=0===t?{emoji:"\uD83E\uDD47",color:"text-yellow-600",label:"1st Place"}:1===t?{emoji:"\uD83E\uDD48",color:"text-gray-400",label:"2nd Place"}:2===t?{emoji:"\uD83E\uDD49",color:"text-orange-600",label:"3rd Place"}:{emoji:"",color:"text-gray-600",label:"".concat(t+1,"th")};return(0,s.jsxs)("tr",{className:t<3?"bg-yellow-50":"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("span",{className:"text-2xl ".concat(r.color," font-bold"),children:[r.emoji," ",t+1]})})}),(0,s.jsxs)("td",{className:"px-6 py-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.address})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded",children:null==(a=e.tier)?void 0:a.replace("_"," ")})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalDeliveries.toLocaleString()}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["$",e.estimatedEarnings.toLocaleString()]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("span",{className:"text-sm font-medium ".concat(j(e.rating,"rating")),children:["★ ",e.rating.toFixed(1)]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("span",{className:"text-sm font-medium ".concat(j(e.deliverySpeed,"speed")),children:[e.deliverySpeed.toFixed(1),"h"]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("span",{className:"text-sm font-medium ".concat(j(e.successRate,"success")),children:[e.successRate.toFixed(1),"%"]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm font-bold text-purple-600",children:e.rankScore.toFixed(1)})})]},e.id)})})]})})]}),(0,s.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Performance Indicators"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-xs text-blue-800",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Rating:"})," Green (4.5+), Blue (4.0+), Yellow (3.5+), Red (<3.5)"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Speed:"})," Green (<18h), Blue (<24h), Yellow (<30h), Red (30h+)"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Success Rate:"})," Green (95%+), Blue (90%+), Yellow (85%+), Red (<85%)"]})]})]})]})})}},6205:(e,t,a)=>{Promise.resolve().then(a.bind(a,2917))},7621:(e,t,a)=>{"use strict";a.d(t,{ZQ:()=>i,bI:()=>n,ic:()=>d,ox:()=>c});var s=a(5125);let r=a(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api/v1",l=s.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let i={login:(e,t)=>l.post("/auth/login",{email:e,password:t}),register:e=>l.post("/auth/register",e),getProfile:()=>l.get("/auth/profile")},n={getAll:()=>l.get("/hubs"),getMyHubs:()=>l.get("/hubs/my-hubs"),getById:e=>l.get("/hubs/".concat(e)),getMetrics:(e,t)=>l.get("/hubs/".concat(e,"/metrics"),{params:{days:t}}),create:e=>l.post("/hubs",e),update:(e,t)=>l.put("/hubs/".concat(e),t)},c={getAll:e=>l.get("/packages",{params:e}),getById:e=>l.get("/packages/".concat(e)),track:e=>l.get("/packages/tracking/".concat(e)),create:e=>l.post("/packages",e),update:(e,t)=>l.put("/packages/".concat(e),t),delete:e=>l.delete("/packages/".concat(e))},d={getDashboard:()=>l.get("/admin/dashboard"),getPendingApplications:(e,t)=>l.get("/admin/applications/pending",{params:{page:e,limit:t}}),getApplicationDetails:e=>l.get("/admin/applications/".concat(e)),reviewApplication:(e,t)=>l.post("/admin/applications/".concat(e,"/review"),t)}}},e=>{e.O(0,[125,441,255,358],()=>e(e.s=6205)),_N_E=e.O()}]);