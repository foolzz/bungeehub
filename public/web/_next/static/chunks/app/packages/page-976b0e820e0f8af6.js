(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[262],{1622:(e,t,a)=>{Promise.resolve().then(a.bind(a,6018))},6018:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),r=a(2115),l=a(7621);function i(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0),[d,n]=(0,r.useState)(""),[c,o]=(0,r.useState)({status:"",hubId:"",page:1,limit:20}),[x,g]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),[u,h]=(0,r.useState)({deliveryTime:new Date().toISOString().slice(0,16),proofPhoto:null,signature:"",requireSignature:!1,notes:""}),[b,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("hubId");e?o(t=>({...t,hubId:e})):j()},[]),(0,r.useEffect)(()=>{(c.hubId||c.status)&&j()},[c]);let j=async()=>{try{var e;i(!0);let a=Object.fromEntries(Object.entries(c).filter(e=>{let[t,a]=e;return""!==a})),s=await l.ox.getAll(a);t((null==(e=s.data)?void 0:e.data)||[])}catch(e){console.error("Error fetching packages:",e),n("Failed to load packages")}finally{i(!1)}},v=async e=>{if(e.preventDefault(),p)try{y(!0);let e="";u.proofPhoto&&(new FileReader().readAsDataURL(u.proofPhoto),e="https://example.com/proof/".concat(p.id,".jpg")),await l.ox.update(p.id,{status:"DELIVERED",deliveredAt:new Date(u.deliveryTime).toISOString(),proofOfDeliveryUrl:e,deliverySignature:u.signature,deliveryNotes:u.notes}),alert("Package marked as delivered successfully!"),g(!1),j()}catch(e){var t,a;console.error("Error updating package:",e),alert("Failed to update package: "+((null==(a=e.response)||null==(t=a.data)?void 0:t.message)||e.message))}finally{y(!1)}};return a?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-xl",children:"Loading packages..."})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Packages"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("a",{href:"/packages/map",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"\uD83D\uDCCD Map View"}),(0,s.jsx)("a",{href:"/dashboard",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Back to Dashboard"})]})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),c.hubId&&(0,s.jsx)("div",{className:"mb-4 text-sm text-gray-600",children:"Filtering by specific hub"}),(0,s.jsx)("div",{className:"grid md:grid-cols-3 gap-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:c.status,onChange:e=>o({...c,status:e.target.value,page:1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900",children:[(0,s.jsx)("option",{value:"",children:"All Statuses"}),(0,s.jsx)("option",{value:"PENDING",children:"Pending"}),(0,s.jsx)("option",{value:"IN_TRANSIT",children:"In Transit"}),(0,s.jsx)("option",{value:"AT_HUB",children:"At Hub"}),(0,s.jsx)("option",{value:"OUT_FOR_DELIVERY",children:"Out for Delivery"}),(0,s.jsx)("option",{value:"DELIVERED",children:"Delivered"}),(0,s.jsx)("option",{value:"FAILED",children:"Failed"}),(0,s.jsx)("option",{value:"RETURNED",children:"Returned"})]})]})})]}),d&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:d}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["All Packages (",e.length,")"]})}),0===e.length?(0,s.jsx)("div",{className:"px-6 py-8 text-center text-gray-500",children:"No packages found"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tracking Number"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recipient"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Delivery Address"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hub"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{var t,a;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.trackingNumber}),e.barcode&&(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["Barcode: ",e.barcode]})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat({PENDING:"bg-yellow-100 text-yellow-800",IN_TRANSIT:"bg-blue-100 text-blue-800",AT_HUB:"bg-purple-100 text-purple-800",OUT_FOR_DELIVERY:"bg-indigo-100 text-indigo-800",DELIVERED:"bg-green-100 text-green-800",FAILED:"bg-red-100 text-red-800",RETURNED:"bg-gray-100 text-gray-800"}[e.status]||"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ")})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e.recipientName||"N/A"}),e.recipientPhone&&(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.recipientPhone})]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-900 max-w-xs",children:e.deliveryAddress||"No address specified"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null==(t=e.assignedHub)?void 0:t.name)||(null==(a=e.hub)?void 0:a.name)||"Not assigned"}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[("OUT_FOR_DELIVERY"===e.status||"AT_HUB"===e.status)&&(0,s.jsx)("button",{onClick:()=>{m(e),h({deliveryTime:new Date().toISOString().slice(0,16),proofPhoto:null,signature:"",requireSignature:!1,notes:""}),g(!0)},className:"text-green-600 hover:text-green-800 font-medium",children:"Mark Delivered"}),"DELIVERED"===e.status&&(0,s.jsx)("span",{className:"text-gray-400",children:"Completed"})]})]},e.id)})})]})})]}),x&&p&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mark Package as Delivered"}),(0,s.jsx)("button",{onClick:()=>g(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",disabled:b,children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:v,className:"p-6",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Package Details"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Tracking:"})," ",p.trackingNumber]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Recipient:"})," ",p.recipientName]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Address:"})," ",p.deliveryAddress]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date & Time *"}),(0,s.jsx)("input",{type:"datetime-local",value:u.deliveryTime,onChange:e=>h({...u,deliveryTime:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proof of Delivery Photo"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&h({...u,proofPhoto:e.target.files[0]})},className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload a photo of the delivered package at the location"}),u.proofPhoto&&(0,s.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["âœ“ Photo selected: ",u.proofPhoto.name]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:u.requireSignature,onChange:e=>h({...u,requireSignature:e.target.checked}),className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Require Signature"})]})}),u.requireSignature&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Signature (Name) *"}),(0,s.jsx)("input",{type:"text",value:u.signature,onChange:e=>h({...u,signature:e.target.value}),placeholder:"Enter recipient's name",className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:u.requireSignature}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"In production, this would be a signature pad for drawing"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Notes (Optional)"}),(0,s.jsx)("textarea",{value:u.notes,onChange:e=>h({...u,notes:e.target.value}),placeholder:"Add any notes about the delivery...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsx)("strong",{children:"Note:"})," Once marked as delivered, the package status will be updated and the customer will be notified. Make sure all information is accurate."]})}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)("button",{type:"submit",disabled:b,className:"flex-1 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 font-medium disabled:bg-gray-400",children:b?"Updating...":"Confirm Delivery"}),(0,s.jsx)("button",{type:"button",onClick:()=>g(!1),disabled:b,className:"flex-1 bg-gray-200 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-300 font-medium disabled:bg-gray-100",children:"Cancel"})]})]})]})]})})]})})}},7621:(e,t,a)=>{"use strict";a.d(t,{ZQ:()=>i,bI:()=>d,ic:()=>c,ox:()=>n});var s=a(5125);let r=a(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api/v1",l=s.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let i={login:(e,t)=>l.post("/auth/login",{email:e,password:t}),register:e=>l.post("/auth/register",e),getProfile:()=>l.get("/auth/profile")},d={getAll:()=>l.get("/hubs"),getMyHubs:()=>l.get("/hubs/my-hubs"),getById:e=>l.get("/hubs/".concat(e)),getMetrics:(e,t)=>l.get("/hubs/".concat(e,"/metrics"),{params:{days:t}}),create:e=>l.post("/hubs",e),update:(e,t)=>l.put("/hubs/".concat(e),t)},n={getAll:e=>l.get("/packages",{params:e}),getById:e=>l.get("/packages/".concat(e)),track:e=>l.get("/packages/tracking/".concat(e)),create:e=>l.post("/packages",e),update:(e,t)=>l.put("/packages/".concat(e),t),delete:e=>l.delete("/packages/".concat(e))},c={getDashboard:()=>l.get("/admin/dashboard"),getPendingApplications:(e,t)=>l.get("/admin/applications/pending",{params:{page:e,limit:t}}),getApplicationDetails:e=>l.get("/admin/applications/".concat(e)),reviewApplication:(e,t)=>l.post("/admin/applications/".concat(e,"/review"),t)}}},e=>{e.O(0,[125,441,255,358],()=>e(e.s=1622)),_N_E=e.O()}]);